function [c_all, w_all, pb_all] = velocity_sets()
% Constructs the velocity set (particle velocity, weight, reversed-direction index) data structures.
% Output:
% - c_all:    Discrete particle velocities for D2Q9, D3Q19, and D3Q27 velocity sets (cell array).
% - w_all:    Corresponding weights for the velocity sets (cell array).
% - pb_all:   Indices i_bar = pb_all{K}(i) such that c_all{K}(:,i_bar+1) = -c_all{K}(:,i).

% Velocity sets and weights.
c_d2q9    = [0, 1, 0, -1, 0, 1, -1, -1,1; 
             0, 0, 1, 0, -1, 1, 1, -1, -1];
w_d2q9    = [4.0/9.0,1.0/9.0,1.0/9.0,1.0/9.0,1.0/9.0,1.0/36.0,1.0/36.0,1.0/36.0,1.0/36.0];
pb_d2q9   = [0,3,4,1,2,7,8,5,6];

c_d3q19   = [0, 1, -1, 0, 0, 0, 0, 1, -1, 1, -1, 0, 0, 1, -1, 1, -1, 0, 0, 1, -1, 1, -1, 1, -1, -1, 1;
             0, 0, 0, 1, -1, 0, 0, 1, -1, 0, 0, 1, -1, -1, 1, 0, 0, 1, -1, 1, -1, 1, -1, -1, 1, 1, -1;
             0, 0, 0, 0, 0, 1, -1, 0, 0, 1, -1, 1, -1, 0, 0, -1, 1, -1, 1, 1, -1, -1, 1, 1, -1, 1, -1];
w_d3q19   = [1.0/3.0,1.0/18.0,1.0/18.0,1.0/18.0,1.0/18.0,1.0/18.0,1.0/18.0,1.0/36.0,1.0/36.0,1.0/36.0,1.0/36.0,1.0/36.0,1.0/36.0,1.0/36.0,1.0/36.0,1.0/36.0,1.0/36.0,1.0/36.0,1.0/36.0];
pb_d3q19  = [0,2,1,4,3,6,5,8,7,10,9,12,11,14,13,16,15,18,17,20,19,22,21,24,23,26,25];

c_d3q27   = [0, 1, -1, 0, 0, 0, 0, 1, -1, 1, -1, 0, 0, 1, -1, 1, -1, 0, 0, 1, -1, 1, -1, 1, -1, -1, 1;
             0, 0, 0, 1, -1, 0, 0, 1, -1, 0, 0, 1, -1, -1, 1, 0, 0, 1, -1, 1, -1, 1, -1, -1, 1, 1, -1;
             0, 0, 0, 0, 0, 1, -1, 0, 0, 1, -1, 1, -1, 0, 0, -1, 1, -1, 1, 1, -1, -1, 1, 1, -1, 1, -1];
w_d3q27   = [8.0/27.0,2.0/27.0,2.0/27.0,2.0/27.0,2.0/27.0,2.0/27.0,2.0/27.0,1.0/54.0,1.0/54.0,1.0/54.0,1.0/54.0,1.0/54.0,1.0/54.0,1.0/54.0,1.0/54.0,1.0/54.0,1.0/54.0,1.0/54.0,1.0/54.0,1.0/216.0,1.0/216.0,1.0/216.0,1.0/216.0,1.0/216.0,1.0/216.0,1.0/216.0,1.0/216.0];
pb_d3q27  = [0,2,1,4,3,6,5,8,7,10,9,12,11,14,13,16,15,18,17,20,19,22,21,24,23,26,25];

% Construct cell arrays.
c_all = {c_d2q9, c_d3q19, c_d3q27};
w_all = {w_d2q9, w_d3q19, w_d3q27};
pb_all = {pb_d2q9, pb_d3q19, pb_d3q27};

endfunction
